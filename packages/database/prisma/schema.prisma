generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  shadowDatabaseUrl = env("DATABASE_SHADOW_URL")
}

model User {
  id        Int      @id @default(autoincrement()) @db.UnsignedInt
  name      String?  @map("nome") @db.VarChar(100)
  login     String   @unique @db.VarChar(100)
  password  String   @map("senha") @db.VarChar(100)
  createdAt DateTime @default(now()) @map("criado_em") @db.DateTime(0)
  updatedAt DateTime @updatedAt @map("alterado_em") @db.DateTime(0)

  recipes Recipe[]

  @@map("usuarios")
}

model Category {
  id   Int     @id @default(autoincrement()) @db.UnsignedInt
  name String? @unique @map("nome") @db.VarChar(100)

  recipes Recipe[]

  @@map("categorias")
}

model Recipe {
  id                Int      @id @default(autoincrement()) @db.UnsignedInt
  userId            Int      @map("id_usuarios") @db.UnsignedInt
  categoryId        Int?     @map("id_categorias") @db.UnsignedInt
  name              String?  @map("nome") @db.VarChar(45)
  preparationTime   Int?     @map("tempo_preparo_minutos") @db.UnsignedInt
  servings          Int?     @map("porcoes") @db.UnsignedInt
  preparationMethod String   @map("modo_preparo") @db.Text
  ingredients       String?  @map("ingredientes") @db.Text
  createdAt         DateTime @default(now()) @map("criado_em") @db.DateTime(0)
  updatedAt         DateTime @updatedAt @map("alterado_em") @db.DateTime(0)

  user     User      @relation(fields: [userId], references: [id], onDelete: Restrict, onUpdate: Cascade)
  category Category? @relation(fields: [categoryId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index([userId], map: "fk_receitas_1_idx")
  @@index([categoryId], map: "fk_receitas_2_idx")
  @@map("receitas")
}
